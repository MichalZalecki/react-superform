!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("_"),require("validator")):"function"==typeof define&&define.amd?define("Superform",["React","_","validator"],t):"object"==typeof exports?exports.Superform=t(require("React"),require("_"),require("validator")):e.Superform=t(e.React,e._,e.validator)}(this,function(e,t,r){return function(e){function t(a){if(r[a])return r[a].exports;var u=r[a]={exports:{},id:a,loaded:!1};return e[a].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var u=r(1),n=a(u);t["default"]=n["default"],e.exports=t["default"]},function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=r(2),f=a(l),d=r(3),c=a(d),h=r(4),m=a(h),v=function(e){function t(e){n(this,t);var r=s(this,Object.getPrototypeOf(t).call(this,e));return r.state={data:{},errors:{},submitted:!1},r}return i(t,e),o(t,[{key:"onSuccessSubmit",value:function(e){}},{key:"onErrorSubmit",value:function(e,t){}},{key:"handleChange",value:function(e){var t=e.target.name,r=this._getNodeValue(e.target),a=this._validateNode(e.target);return Promise.all([this._updateDataOf(t,r),this._updateErrorsOf(t,a)])}},{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var r=this._createErrors();return this.markAsSubmitted().then(function(){return t._updateErrors(r)}).then(function(){return t.isFormValid()?t.onSuccessSubmit(t.state.data):t.onErrorSubmit(t.state.errors,t.state.data)})}},{key:"markAsSubmitted",value:function(){var e=this;return new Promise(function(t){e.setState({submitted:!0},t)})}},{key:"isSubmited",value:function(){return this.state.submitted}},{key:"getValueOf",value:function(e){return this.state.data[e]}},{key:"linkStateOf",value:function(e){var t=this;return{value:this.state.data[e],requestChange:function(){return t.handleChange({target:t.refs[e]})}}}},{key:"getData",value:function(){return this.state.data}},{key:"getErrors",value:function(){var e=(0,c["default"])(this.state.errors).omitBy(function(e){return!e.length}).value();return e}},{key:"getErrorsOf",value:function(e){var t=(0,c["default"])(this.getErrors()).pick(e).get(e,[]);return t}},{key:"isFormValid",value:function(){var e=(0,c["default"])(this.getErrors()).keys().isEmpty();return e}},{key:"isFieldValid",value:function(e){var t=(0,c["default"])(this.getErrorsOf(e)).isEmpty();return t}},{key:"getErrorMessageOf",value:function(e){if(!this.isSubmited()||this.isFieldValid(e))return null;var t=(0,c["default"])(this.getErrorsOf(e)).first(),r=this._getMessage(e,t.rule);return t.data?this._parseMessage(r,t.data):r}},{key:"_createErrors",value:function(){var e=this;return(0,c["default"])(this.refs).mapValues(function(t){return e._validateNode(t)}).omitBy(function(e){return!e.length}).value()}},{key:"_updateErrors",value:function(e){var t=this;return new Promise(function(r){t.setState({errors:e},r)})}},{key:"_updateDataOf",value:function(e,t){var r=this;return new Promise(function(a){var n=c["default"].assign({},r.state.data,u({},e,t));r.setState({data:n},a)})}},{key:"_updateErrorsOf",value:function(e,t){var r=this;return new Promise(function(a){var n=c["default"].assign({},r.state.errors,u({},e,t));r.setState({errors:n},a)})}},{key:"_getCustomMessageForRuleOf",value:function(e,t){var r=this._getCustomMessagesOf(e),a=r[t];return a}},{key:"_getCustomMessagesOf",value:function(e){var t=this.refs[e].dataset.messages,r=t?JSON.parse(t):{};return r}},{key:"_getMessage",value:function(e,t){var r=this._getCustomMessageForRuleOf(e,t)||this.constructor.DEFAULT_MESSAGES[t];if(!r)throw new Error("Superform: There is no message for such rule. Passed: "+t);return r}},{key:"_parseMessage",value:function(e,t){var r=e.replace(":data",t);return r}},{key:"_validateNode",value:function(e){var t=this._getNodeValue(e),r=this._collectRules(e),a=this._validate(t,r);return a}},{key:"_getNodeValue",value:function(e){switch(e.type){case"checkbox":return e.checked;default:return e.value}}},{key:"_collectRules",value:function(e){var t={email:"email"===e.type,url:"url"===e.type,pattern:e.pattern,required:e.required,min:e.getAttribute("min"),max:e.getAttribute("max"),minLength:e.getAttribute("minLength"),maxLength:e.getAttribute("maxLength"),equals:e.dataset.equals};return t}},{key:"_validate",value:function(e,t){var r=[];return t.required&&!this._valueExists(e)&&r.push({rule:"required"}),t.pattern?t.pattern&&!this._valueMatchesPattern(e,t.pattern)&&r.push({rule:"pattern"}):(t.email&&!m["default"].isEmail(e)&&r.push({rule:"email"}),t.url&&!m["default"].isURL(e,{require_protocol:!0})&&r.push({rule:"url"})),(t.required||this._valueExists(e))&&(t.min&&!this._valueIsGreaterOrEqual(e,t.min)&&r.push({rule:"min",data:t.min}),t.max&&!this._valueIsLowerOrEqual(e,t.max)&&r.push({rule:"max",data:t.max}),t.minLength&&!this._valueLengthIsGreaterOrEqual(e,t.minLength)&&r.push({rule:"minLength",data:t.minLength}),t.maxLength&&!this._valueLengthIsLowerOrEqual(e,t.maxLength)&&r.push({rule:"maxLength",data:t.maxLength})),t.equals&&!this._valueEqualsValueOf(e,t.equals)&&r.push({rule:"equals",data:t.equals}),r}},{key:"_valueMatchesPattern",value:function(e,t){return new RegExp(t).test(e)}},{key:"_valueExists",value:function(e){return!!e}},{key:"_valueIsGreaterOrEqual",value:function(e,t){var r=parseInt(e),a=parseInt(t);if(Number.isNaN(a))throw Error('Superform: Invalid "min" rule. Use only with numbers. Passed: '+JSON.stringify(t));return Number.isNaN(r)?!1:r>=a}},{key:"_valueIsLowerOrEqual",value:function(e,t){var r=parseInt(e),a=parseInt(t);if(Number.isNaN(a))throw Error('Superform: Invalid "max" rule. Use only with numbers. Passed: '+JSON.stringify(t));return Number.isNaN(r)?!1:a>=r}},{key:"_valueLengthIsGreaterOrEqual",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],t=arguments[1],r=e.length,a=parseInt(t);if(Number.isNaN(a))throw Error('Superform: Invalid "minLength" rule. Use only with numbers. Passed: '+JSON.stringify(t));return r>=a}},{key:"_valueLengthIsLowerOrEqual",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0],t=arguments[1],r=e.length,a=parseInt(t);if(Number.isNaN(a))throw Error('Superform: Invalid "maxLength" rule. Use only with numbers. Passed: '+JSON.stringify(t));return a>=r}},{key:"_valueEqualsValueOf",value:function(e,t){return e===this.getValueOf(t)}}]),t}(f["default"].Component);v.DEFAULT_MESSAGES={email:"This is not a valid email.",url:"This is not a valid URL.",required:"Field is required.",pattern:"Value format is invalid.",min:"Value should be greater or equal :data.",max:"Value should be lower or equal :data.",minLength:"Value is too short. Value length should be greater or equal :data.",maxLength:"Value is too long. Value length should be lower or equal :data.",equals:"Value must be the same as :data."},t["default"]=v,e.exports=t["default"]},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r}])});
//# sourceMappingURL=react-superform.min.js.map
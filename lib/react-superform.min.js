!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("React"),require("_"),require("validator")):"function"==typeof define&&define.amd?define("Superform",["React","_","validator"],t):"object"==typeof exports?exports.Superform=t(require("React"),require("_"),require("validator")):e.Superform=t(e.React,e._,e.validator)}(this,function(e,t,r){return function(e){function t(a){if(r[a])return r[a].exports;var u=r[a]={exports:{},id:a,loaded:!1};return e[a].call(u.exports,u,u.exports,t),u.loaded=!0,u.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function a(e){return e&&e.__esModule?e:{"default":e}}function u(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}(),l=r(1),f=a(l),h=r(2),d=a(h),c=r(3),v=a(c),m=function(e){function t(e){n(this,t);var r=i(this,Object.getPrototypeOf(t).call(this,e));return r.state={data:{},errors:{},submited:!1},r}return s(t,e),o(t,[{key:"handleSubmit",value:function(e){var t=this;e.preventDefault();var r=this._createErrors();return this.markAsSubmited().then(function(){return t._updateErrors(r)})}},{key:"handleChange",value:function(e){var t=e.target.name,r=e.target.value,a=this._validateNode(e.target);return Promise.all([this._updateDataOf(t,r),this._updateErrorsOf(t,a)])}},{key:"markAsSubmited",value:function(){var e=this;return new Promise(function(t){e.setState({submited:!0},t)})}},{key:"isSubmited",value:function(){return this.state.submited}},{key:"getValueOf",value:function(e){return this.state.data[e]}},{key:"linkStateOf",value:function(e){var t=this;return{value:this.state.data[e],requestChange:function(){return t.handleChange({target:t.refs[e]})}}}},{key:"getErrors",value:function(){var e=(0,d["default"])(this.state.errors).omitBy(function(e){return!e.length}).value();return e}},{key:"getErrorsOf",value:function(e){var t=(0,d["default"])(this.getErrors()).pick(e).get(e,[]);return t}},{key:"isFormValid",value:function(){var e=(0,d["default"])(this.getErrors()).keys().isEmpty();return e}},{key:"isFieldValid",value:function(e){var t=(0,d["default"])(this.getErrorsOf(e)).isEmpty();return t}},{key:"getErrorMessageOf",value:function(e){if(!this.isSubmited()||this.isFieldValid(e))return null;var t=(0,d["default"])(this.getErrorsOf(e)).first(),r=this._getMessage(t.rule,e);return t.data?this._parseMessage(r,t.data):r}},{key:"_createErrors",value:function(){var e=this;return(0,d["default"])(this.refs).mapValues(function(t){return e._validateNode(t)}).omitBy(function(e){return!e.length}).value()}},{key:"_updateErrors",value:function(e){var t=this;return new Promise(function(r){var a=d["default"].assign({},t.state.errors,e);t.setState({errors:a},r)})}},{key:"_updateDataOf",value:function(e,t){var r=this;return new Promise(function(a){var n=d["default"].assign({},r.state.data,u({},e,t));r.setState({data:n},a)})}},{key:"_updateErrorsOf",value:function(e,t){var r=this;return new Promise(function(a){var n=d["default"].assign({},r.state.errors,u({},e,t));r.setState({errors:n},a)})}},{key:"_getCustomMessagesOf",value:function(e){var t=this.refs[e].dataset.messages,r=t?JSON.parse(t):{};return r}},{key:"_getCustomMessageForRuleOf",value:function(e,t){var r=this._getCustomMessagesOf(e),a=r[t];return a}},{key:"_getCustomMessagesOf",value:function(e){var t=this.refs[e].dataset.messages,r=t?JSON.parse(t):{};return r}},{key:"_getMessage",value:function(e,t){var r=this._getCustomMessageForRuleOf(t,e)||this.constructor.DEFAULT_MESSAGES[e];if(!r)throw new Error("Superform: There is no message for such rule. Passed: "+e);return r}},{key:"_parseMessage",value:function(e,t){var r=e.replace(":data",t);return r}},{key:"_validateNode",value:function(e){var t=(e.name,e.value),r=this._collectRules(e),a=this._validate(t,r);return a}},{key:"_collectRules",value:function(e){var t={email:"email"===e.type,url:"url"===e.type,pattern:e.pattern,required:e.required,min:e.getAttribute("min"),max:e.getAttribute("max"),minLength:e.getAttribute("minLength"),maxLength:e.getAttribute("maxLength")};return t}},{key:"_validate",value:function(e,t){var r=[];return t.required&&!this._valueExists(e)&&r.push({rule:"required"}),t.pattern?t.pattern&&!this._valueMatchesPattern(e,t.pattern)&&r.push({rule:"pattern"}):(t.email&&!v["default"].isEmail(e)&&r.push({rule:"email"}),t.url&&!v["default"].isURL(e,{require_protocol:!0})&&r.push({rule:"url"})),(t.required||this._valueExists(e))&&(t.min&&!this._valueIsGreaterOrEqual(e,t.min)&&r.push({rule:"min",data:t.min}),t.max&&!this._valueIsLowerOrEqual(e,t.max)&&r.push({rule:"max",data:t.max}),t.minLength&&!this._valueLengthIsGreaterOrEqual(e,t.minLength)&&r.push({rule:"minLength",data:t.minLength}),t.maxLength&&!this._valueLengthIsLowerOrEqual(e,t.maxLength)&&r.push({rule:"maxLength",data:t.maxLength})),r}},{key:"_valueMatchesPattern",value:function(e,t){return new RegExp(t).test(e)}},{key:"_valueExists",value:function(e){return!!e}},{key:"_valueIsGreaterOrEqual",value:function(e,t){var r=parseInt(e),a=parseInt(t);if(Number.isNaN(a))throw Error('Superform: Invalid "min" rule. Use only with numbers. Passed: '+JSON.stringify(t));return Number.isNaN(r)?!1:r>=a}},{key:"_valueIsLowerOrEqual",value:function(e,t){var r=parseInt(e),a=parseInt(t);if(Number.isNaN(a))throw Error('Superform: Invalid "max" rule. Use only with numbers. Passed: '+JSON.stringify(t));return Number.isNaN(r)?!1:a>=r}},{key:"_valueLengthIsGreaterOrEqual",value:function(e,t){var r=e.length,a=parseInt(t);if(Number.isNaN(a))throw Error('Superform: Invalid "minLength" rule. Use only with numbers. Passed: '+JSON.stringify(t));return r>=a}},{key:"_valueLengthIsLowerOrEqual",value:function(e,t){var r=e.length,a=parseInt(t);if(Number.isNaN(a))throw Error('Superform: Invalid "maxLength" rule. Use only with numbers. Passed: '+JSON.stringify(t));return a>=r}}]),t}(f["default"].Component);t["default"]=m,m.DEFAULT_MESSAGES={email:"This is not a valid email.",url:"This is not a valid URL.",required:"Field is required.",pattern:"Value format is invalid.",min:"Value should be greater or equal :data.",max:"Value should be lower or equal :data.",minLength:"Value is too short. Value length should be greater or equal :data.",maxLength:"Value is too long. Value length should be lower or equal :data."},e.exports=t["default"]},function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r}])});
//# sourceMappingURL=react-superform.min.js.map